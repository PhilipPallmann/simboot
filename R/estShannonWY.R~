estShannonWY <-
function (x)
{
  Nspec <- length(x)
  Nind <- sum(x)
  estp <- as.numeric(x)/Nind
  estpo0 <- estp[estp > 0]
  pvec <- matrix(estpo0, ncol = 1)
  m1 <- diag(estpo0) - (pvec %*% t(pvec))
  sigma2 <- (t(log(pvec)) %*% m1) %*% log(pvec)
  estH <- (-1) * sum(estpo0 * log(estpo0))
  estHBC <- estH + (Nspec - 1)/(2 * Nind)
  varest <- as.numeric(sigma2)/Nind
  out <- estHBC
  return(out)
}

